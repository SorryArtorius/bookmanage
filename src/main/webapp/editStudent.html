<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学习信息修改</title>
    <script src="/java16_SSM_816_war/js/jquery-3.6.0.js"></script>
    <script>
        $(function () {
            $.getJSON("/java16_SSM_816_war/student/selectEditStudent", function (json) {
                var tb = $("#tb");
                $("#tb tr").remove();
                var str = "";

                /**
                 * 数据添加操作
                 * @type {string}
                 */
                str += "<tr>";
                str += "<td>学号:</td><td><input type='text' name='studentNo' readonly value='" + json.studentNo + "' disabled></td>";
                str += "</tr>";


                str += "<tr>";
                str += "<td>姓名:</td><td><input type='text' name='studentName'  value='" + json.studentName + "'></td>";
                str += "</tr>";

                if (json.sex == "男") {
                    str += "<tr>";
                    str += "<td>性别:</td><td><input type='radio' name='sex'  value='男' checked>男" +
                        "<input type='radio' name='sex'  value='女' >女</td>";
                    str += "</tr>";
                } else {
                    str += "<tr>";
                    str += "<td>性别:</td><td><input type='radio' name='sex'  value='男'>男" +
                        "<input type='radio' name='sex'  value='女' checked>女</td>";
                    str += "</tr>";
                }

                str += "<tr>";
                str += "<td>密码:</td><td><input type='text' name='loginPwd'  value='" + json.loginPwd + "'></td>";
                str += "</tr>";

                str += "<tr>";
                str += "<td>年级:</td>";
                str += "<td>"


                /**
                 * 年级请求
                 * @type {string}
                 */
                str += "<select id='selectGrade' name='grade'>";
                str += "<option value='" + json.grade.gradeId + "' selected>" + json.grade.gradeName + "</option>";
                str += "</select>";

                str += "</td>";
                str += "</tr>";


                str += "<tr>";
                str += "<td>电话:</td><td><input type='text' name='phone'  value='" + json.phone + "'></td>";
                str += "</tr>";

                str += "<tr>";
                str += "<td>地址:</td><td><input type='text' name='address'  value='" + json.address + "'></td>";
                str += "</tr>";

                str += "<tr>";
                str += "<td>出生日期:</td><td><input type='text' name='bornDate'  value='" + json.bornDate + "'></td>";
                str += "</tr>";

                str += "<tr>";
                str += "<td>电子邮箱:</td><td><input type='text' name='email'  value='" + json.email + "'></td>";
                str += "</tr>";


                str += "<tr>";
                str += "<td>身份证:</td><td><input type='text' name='identityCard'  value='" + json.identityCard + "'></td>";
                str += "</tr>";

                tb.append(str);

                str = "";
                var selectGrade = $("#selectGrade").val();
                $.getJSON("/java16_SSM_816_war/grade/getGrades", function (data) {
                    for (i = 0; i < data.length; i++) {
                        if (data[i].gradeId != selectGrade) {
                            str += "<option value='" + data[i].gradeId + "'>" + data[i].gradeName + "</option>";
                        }
                    }
                    $("#selectGrade").append(str);

                });

            });

        });

        function updateData() {

            var r = confirm("您确定修改吗？")
            if (r == true) {
                var studentNo = $("input[name='studentNo']").val();
                var studentName = $("input[name='studentName']").val();
                var sex = $("input[name='sex']:checked").val();
                var loginPwd = $("input[name='loginPwd']").val();
                var grade = $("select[name='grade']").val();
                var phone = $("input[name='phone']").val();
                var address = $("input[name='address']").val();
                var bornDate = $("input[name='bornDate']").val();
                var email = $("input[name='email']").val();
                var identityCard = $("input[name='identityCard']").val();

                $.post("/java16_SSM_816_war/student/updateStudent", {
                        studentNo: studentNo,
                        studentName: studentName,
                        loginPwd: loginPwd,
                        sex: sex,
                        grade: grade,
                        phone: phone,
                        address: address,
                        bornDate: bornDate,
                        email: email,
                        identityCard: identityCard
                    },
                    function (data) {
                        console.log(data);
                        alert(data);
                        if (data == true) {
                            window.location.href="/java16_SSM_816_war/student.html";
                        } else {
                            alert("修改出现异常");
                        }
                    });
            }
        }
    </script>
</head>
<body>
<div id="tb">
</div>
<input onclick="updateData();" type='submit' value='更改'/>
</body>
</html>